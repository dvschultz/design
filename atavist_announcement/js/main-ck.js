function clickAttach(){$("a").on("click",function(e){e.stopPropagation();e.preventDefault();if(!$(this).attr("data-atbooks-ref"))return!0;var t=$(this).attr("data-atbooks-ref"),n=$(t).html();$("#popup").append(n);$("#popup").toggleClass("visible");$(document).bind("click",function(e){$("#popup").toggleClass("visible");$("#popup").html("");$(document).unbind("click")})})}function sticky(){$("html").hasClass("no-csspositionsticky")&&$(".forthcoming,.team").each(function(){var e=$(this).height();$(window).scrollTop()>=$(this)[0].offsetTop&&$(window).scrollTop()<=$(this)[0].offsetTop+$(this)[0].offsetHeight?$(this).height(e).addClass("sticky"):$(this).height("auto").removeClass("sticky")})}function parallax(){}function mapVal(e){spreadMax=1;var t;e<0||e>1?t=spreadMax:e>0&&e<.25?t=Math.abs(e-.25)*(spreadMax/.25):e>.75&&e<1?t=Math.abs(e-.75)*(spreadMax/.25):t=0;return t}function fadeInColor(){$(".different,.learn-more").each(function(){if($(this).attr("data-atbooks-fadeto")){var e=$(this).offset().top-window.innerHeight,t=$(this).attr("data-atbooks-fadeto"),n=t.match(/(\.)?\d+/g),r=($(window).scrollTop()-e)/window.innerHeight*n[3];if($(window).scrollTop()>=e){var i="rgba("+n[0]+","+n[1]+","+n[2]+","+r+")";$(this).css("background-color",i)}else $(this).css("background-color","transparent")}})}function scrollFade(){$(".forthcoming").find(".title").each(function(){var e=$(window).scrollTop(),t=$(this)[0].offsetHeight,n=window.innerHeight/2,r=$(this).offset().top-window.innerHeight,i=$(this).offset().top+t,s=r+n,o=Math.abs($(window).scrollTop()-($(this).offset().top-n));if(e>=r&&e<=s){currOpacity=1-(s-e)/n;console.log(currOpacity);$(this).css("opacity",currOpacity)}else $(this).css("opacity",1)})}function sleepDonation(){$(".s-cap").each(function(e){var t=document.querySelectorAll("#svgS path");for(var n=0;n<t.length;n++){var r=t[n].getTotalLength();t[n].setAttribute("data-atbooks-length",r);t[n].style.strokeDasharray=r+" "+r}var i=document.querySelectorAll("#svgS rect");for(var s=0;s<i.length;s++){totalL=293.74;i[s].setAttribute("data-atbooks-length",totalL)}})}function addAngles(){var e=['<div class="svgAngle" style="height: 462px; width: 335px;"><svg xmlns="http://www.w3.org/2000/svg" width="334.26" height="462.478"><path d="M109.05 3.5l221.71 455.478" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><path d="M213.381 293.29h-209.296" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/></svg><div>','<div class="svgAngle" style="height: 462px; width: 335px;"><svg xmlns="http://www.w3.org/2000/svg" width="334.26" height="462.478"><path d="M225.795 3.5l-221.71 455.478" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><path d="M121.464 293.29h209.296" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/></svg><div>','<div class="svgAngle" style="height: 462px; width: 335px;"><svg xmlns="http://www.w3.org/2000/svg" width="334.26" height="462.478"><path d="M225.795 3.5l-221.71 455.478" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><path d="M121.464 293.29h209.296" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/></svg><div>','<div class="svgAngle" style="height: 462px; width: 335px;"><svg xmlns="http://www.w3.org/2000/svg" width="334.26" height="462.478"><path d="M109.05 3.5l221.71 455.478" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><path d="M213.381 293.29h-209.296" stroke="rgba(204,51,51,1)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/></svg><div>'],t=['<div class="svgAngle" style="height: 99px; width: 50px;"><svg xmlns="http://www.w3.org/2000/svg" width="49.728" height="99"><path d="M1.5 1.5l46.728 96" stroke="rgba(0,0,0,.3)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/></svg></div>','<div class="svgAngle" style="height: 99px; width: 50px;"><svg xmlns="http://www.w3.org/2000/svg" width="49.728" height="99"><path d="M48.228 1.5l-46.728 96" stroke="rgba(0,0,0,.3)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/></svg></div>'],n=0;$(".team").find("li").each(function(t){var r=$(this).position();$(e[t]).attr("id","svgAngle"+t).appendTo($(".team .body")).css({display:"block",top:r.top+"px",position:"absolute"});n=t});$("html").hasClass("no-ios")&&$(".praise").find("figure").each(function(e){var r=Math.floor(Math.random()*2+0);$(t[r]).attr("id","svgAngle"+(n+e)).appendTo($(this))});$(".svgAngle").each(function(e){var t=document.querySelectorAll("#svgAngle"+e+" path");for(var n=0;n<t.length;n++){var r=t[n].getTotalLength();t[n].setAttribute("data-atbooks-length",r);t[n].style.strokeDasharray=r+" "+r}})}function praise(){}function drawLines(){$(".svgAngle").each(function(e){var t=document.querySelectorAll("#svgAngle"+e+" path"),n=$(window).scrollTop()-$(this).offset().top,r=$(this)[0].offsetHeight,i=window.innerHeight/2,s=$(this).offset().top-window.innerHeight+i/2,o=$(this).offset().top+r+i/2,u=$(window).scrollTop(),r=$(this)[0].offsetHeight;for(var a=0;a<t.length;a++){var f=(u-s)/(o-s),l=t[a].getAttribute("data-atbooks-length"),c=l*2,h=c*f;t[a].style.strokeDashoffset=l-h}});$(".s-cap").each(function(e){var t=document.querySelectorAll("#svgS path"),n=document.querySelectorAll("#svgS rect"),r=$(window).scrollTop()-$(this).offset().top,i=$(this)[0].offsetHeight,s=window.innerHeight/2,o=$(this).offset().top-window.innerHeight+s/2,u=$(this).offset().top+i+s/2,a=$(window).scrollTop(),i=$(this)[0].offsetHeight;for(var f=0;f<t.length;f++){var l=(a-o)/(u-o),c=t[f].getAttribute("data-atbooks-length"),h=c*2,p=h*l;t[f].style.strokeDashoffset=c-p}for(var d=0;d<n.length;d++){var l=(a-o)/(u-o),v=n[d].getAttribute("data-atbooks-length"),h=v*2,p=h*l;n[d].style.strokeDasharray=totalL*0+p+" "+(totalL-p)}})}function minMaxMap(e,t,n){var r;return e<t?0:e>n?1:1*(e-t)/(n-t)}$(document).ready(function(){function n(){if(e<1024){var t=$(".parallax-container"),n=$(".parallax-container").width(),r=$(".parallax-container").height(),i=n/1024;pch=Math.ceil(i*n*.46875);console.log(pch);t.css({"-webkit-transform":"scale("+i+")"}).height(480).width(1024)}}function r(){var e=[],t=[];$(".letter").each(function(n,r){var i=Math.random()*2,s=r.id;e[n]=document.querySelector("#"+s+" path");t[n]=e[n].getTotalLength();e[n].style.transition=e[n].style.WebkitTransition="none";e[n].style.strokeDasharray=t[n]+" "+t[n];e[n].style.strokeDashoffset=t[n];e[n].getBoundingClientRect();e[n].style.transition=e[n].style.WebkitTransition="stroke-dashoffset 2s ease "+i+"s, stroke  2s ease 0s";e[n].style.strokeDashoffset="0"})}function i(){var e=$(window).scrollTop();e>=1?$("#letter1-part1,#letter1-part2").addClass("red"):e<=0&&$("#letter1-part1,#letter1-part2").removeClass("red");$(".letter").each(function(){var t=$(this).attr("data-speed");$(this).css("top",10-e*t+"vh")});$("#letter1-part1,#letter1-part2").each(function(){var e="rgb(35,31,32)",t="rgb(35,31,32)"})}Modernizr.addTest("ipad",function(){return!!navigator.userAgent.match(/iPad/i)});Modernizr.addTest("iphone",function(){return!!navigator.userAgent.match(/iPhone/i)});Modernizr.addTest("ipod",function(){return!!navigator.userAgent.match(/iPod/i)});Modernizr.addTest("chrome",function(){return!!navigator.userAgent.toLowerCase().match(/chrom(e|ium)/)});Modernizr.addTest("ios",function(){return Modernizr.ipad||Modernizr.ipod||Modernizr.iphone});var e=window.innerWidth,t=window.innerHeight;n();r();addAngles();sleepDonation();$(window).bind("resize",function(t){e=window.innerWidth;n()});$(window).bind("scroll",function(e){if($("html").hasClass("no-ios")){i();parallax();sticky();scrollFade();fadeInColor();drawLines()}})});